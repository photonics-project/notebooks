"use strict";(self.webpackChunk_JUPYTERLAB_CORE_OUTPUT=self.webpackChunk_JUPYTERLAB_CORE_OUTPUT||[]).push([[5498],{22742:(e,t,s)=>{s.d(t,{E:()=>i});var n,r=s(30427);class i{constructor(e={}){if(this._map=new Map,this._changed=new r.Signal(this),this._isDisposed=!1,this._itemCmp=e.itemCmp||n.itemCmp,e.values)for(const t in e.values)this._map.set(t,e.values[t])}get type(){return"Map"}get changed(){return this._changed}get isDisposed(){return this._isDisposed}get size(){return this._map.size}set(e,t){const s=this._map.get(e);if(void 0===t)throw Error("Cannot set an undefined value, use remove");const n=this._itemCmp;return void 0!==s&&n(s,t)||(this._map.set(e,t),this._changed.emit({type:s?"change":"add",key:e,oldValue:s,newValue:t})),s}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){const e=[];return this._map.forEach(((t,s)=>{e.push(s)})),e}values(){const e=[];return this._map.forEach(((t,s)=>{e.push(t)})),e}delete(e){const t=this._map.get(e);return this._map.delete(e)&&this._changed.emit({type:"remove",key:e,oldValue:t,newValue:void 0}),t}clear(){const e=this.keys();for(let t=0;t<e.length;t++)this.delete(e[t])}dispose(){this.isDisposed||(this._isDisposed=!0,r.Signal.clearData(this),this._map.clear())}}!function(e){e.itemCmp=function(e,t){return e===t}}(n||(n={}))},89909:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.supportedKernelWebSocketProtocols=t.isInputReplyMsg=t.isInputRequestMsg=t.isDebugReplyMsg=t.isDebugRequestMsg=t.isExecuteReplyMsg=t.isInfoRequestMsg=t.isCommMsgMsg=t.isCommCloseMsg=t.isCommOpenMsg=t.isDebugEventMsg=t.isClearOutputMsg=t.isStatusMsg=t.isErrorMsg=t.isExecuteResultMsg=t.isExecuteInputMsg=t.isUpdateDisplayDataMsg=t.isDisplayDataMsg=t.isStreamMsg=t.createMessage=void 0;const n=s(68211);var r;t.createMessage=function(e){var t,s,r,i,a;return{buffers:null!==(t=e.buffers)&&void 0!==t?t:[],channel:e.channel,content:e.content,header:{date:(new Date).toISOString(),msg_id:null!==(s=e.msgId)&&void 0!==s?s:n.UUID.uuid4(),msg_type:e.msgType,session:e.session,username:null!==(r=e.username)&&void 0!==r?r:"",version:"5.2"},metadata:null!==(i=e.metadata)&&void 0!==i?i:{},parent_header:null!==(a=e.parentHeader)&&void 0!==a?a:{}}},t.isStreamMsg=function(e){return"stream"===e.header.msg_type},t.isDisplayDataMsg=function(e){return"display_data"===e.header.msg_type},t.isUpdateDisplayDataMsg=function(e){return"update_display_data"===e.header.msg_type},t.isExecuteInputMsg=function(e){return"execute_input"===e.header.msg_type},t.isExecuteResultMsg=function(e){return"execute_result"===e.header.msg_type},t.isErrorMsg=function(e){return"error"===e.header.msg_type},t.isStatusMsg=function(e){return"status"===e.header.msg_type},t.isClearOutputMsg=function(e){return"clear_output"===e.header.msg_type},t.isDebugEventMsg=function(e){return"debug_event"===e.header.msg_type},t.isCommOpenMsg=function(e){return"comm_open"===e.header.msg_type},t.isCommCloseMsg=function(e){return"comm_close"===e.header.msg_type},t.isCommMsgMsg=function(e){return"comm_msg"===e.header.msg_type},t.isInfoRequestMsg=function(e){return"kernel_info_request"===e.header.msg_type},t.isExecuteReplyMsg=function(e){return"execute_reply"===e.header.msg_type},t.isDebugRequestMsg=function(e){return"debug_request"===e.header.msg_type},t.isDebugReplyMsg=function(e){return"debug_reply"===e.header.msg_type},t.isInputRequestMsg=function(e){return"input_request"===e.header.msg_type},t.isInputReplyMsg=function(e){return"input_reply"===e.header.msg_type},function(e){e.v1KernelWebsocketJupyterOrg="v1.kernel.websocket.jupyter.org"}(r||(t.supportedKernelWebSocketProtocols=r={}))},57179:function(e,t,s){var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var r=Object.getOwnPropertyDescriptor(t,s);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,r)}:function(e,t,s,n){void 0===n&&(n=s),e[n]=t[s]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.deserialize=t.serialize=void 0;const a=i(s(89909));var o;t.serialize=function(e,t=""){return t===a.supportedKernelWebSocketProtocols.v1KernelWebsocketJupyterOrg?o.serializeV1KernelWebsocketJupyterOrg(e):o.serializeDefault(e)},t.deserialize=function(e,t=""){return t===a.supportedKernelWebSocketProtocols.v1KernelWebsocketJupyterOrg?o.deserializeV1KernelWebsocketJupyterOrg(e):o.deserializeDefault(e)},function(e){e.deserializeV1KernelWebsocketJupyterOrg=function(e){let t;const s=new DataView(e),n=Number(s.getBigUint64(0,!0));let r=[];for(let e=0;e<n;e++)r.push(Number(s.getBigUint64(8*(e+1),!0)));const i=new TextDecoder("utf8"),a=i.decode(e.slice(r[0],r[1])),o=JSON.parse(i.decode(e.slice(r[1],r[2]))),c=JSON.parse(i.decode(e.slice(r[2],r[3]))),l=JSON.parse(i.decode(e.slice(r[3],r[4]))),u=JSON.parse(i.decode(e.slice(r[4],r[5])));let h=[];for(let t=5;t<r.length-1;t++)h.push(new DataView(e.slice(r[t],r[t+1])));return t={channel:a,header:o,parent_header:c,metadata:l,content:u,buffers:h},t},e.serializeV1KernelWebsocketJupyterOrg=function(e){const t=JSON.stringify(e.header),s=null==e.parent_header?"{}":JSON.stringify(e.parent_header),n=JSON.stringify(e.metadata),r=JSON.stringify(e.content),i=void 0!==e.buffers?e.buffers:[],a=5+i.length+1;let o=[];o.push(8*(1+a)),o.push(e.channel.length+o[o.length-1]);const c=new TextEncoder,l=c.encode(e.channel),u=c.encode(t),h=c.encode(s),d=c.encode(n),p=c.encode(r),g=new Uint8Array(l.length+u.length+h.length+d.length+p.length);g.set(l),g.set(u,l.length),g.set(h,l.length+u.length),g.set(d,l.length+u.length+h.length),g.set(p,l.length+u.length+h.length+d.length);for(let e of[u.length,h.length,d.length,p.length])o.push(e+o[o.length-1]);let _=0;for(let e of i){let t=e.byteLength;o.push(t+o[o.length-1]),_+=t}const f=new Uint8Array(8*(1+a)+g.byteLength+_),m=new ArrayBuffer(8),y=new DataView(m);y.setBigUint64(0,BigInt(a),!0),f.set(new Uint8Array(m),0);for(let e=0;e<o.length;e++)y.setBigUint64(0,BigInt(o[e]),!0),f.set(new Uint8Array(m),8*(e+1));f.set(g,o[0]);for(let e=0;e<i.length;e++){const t=i[e];f.set(new Uint8Array(ArrayBuffer.isView(t)?t.buffer:t),o[5+e])}return f.buffer},e.deserializeDefault=function(e){let t;return t="string"==typeof e?JSON.parse(e):function(e){const t=new DataView(e),s=t.getUint32(0),n=[];if(s<2)throw new Error("Invalid incoming Kernel Message");for(let e=1;e<=s;e++)n.push(t.getUint32(4*e));const r=new Uint8Array(e.slice(n[0],n[1])),i=JSON.parse(new TextDecoder("utf8").decode(r));i.buffers=[];for(let t=1;t<s;t++){const s=n[t],r=n[t+1]||e.byteLength;i.buffers.push(new DataView(e.slice(s,r)))}return i}(e),t},e.serializeDefault=function(e){var t;let s;return s=(null===(t=e.buffers)||void 0===t?void 0:t.length)?function(e){const t=[],s=[],n=new TextEncoder;let r=[];void 0!==e.buffers&&(r=e.buffers,delete e.buffers);const i=n.encode(JSON.stringify(e));s.push(i.buffer);for(let e=0;e<r.length;e++){const t=r[e];s.push(ArrayBuffer.isView(t)?t.buffer:t)}const a=s.length;t.push(4*(a+1));for(let e=0;e+1<s.length;e++)t.push(t[t.length-1]+s[e].byteLength);const o=new Uint8Array(t[t.length-1]+s[s.length-1].byteLength),c=new DataView(o.buffer);c.setUint32(0,a);for(let e=0;e<t.length;e++)c.setUint32(4*(e+1),t[e]);for(let e=0;e<s.length;e++)o.set(new Uint8Array(s[e]),t[e]);return o.buffer}(e):JSON.stringify(e),s}}(o||(o={}))},95498:(e,t,s)=>{s.r(t),s.d(t,{BaseKernel:()=>i,FALLBACK_KERNEL:()=>v,IKernelSpecs:()=>w,IKernels:()=>y,KernelSpecs:()=>M,Kernels:()=>m});var n=s(6769),r=s(30427);class i{constructor(e){this._history=[],this._executionCount=0,this._isDisposed=!1,this._disposed=new r.Signal(this),this._parentHeader=void 0,this._parent=void 0;const{id:t,name:s,location:n,sendMessage:i}=e;this._id=t,this._name=s,this._location=n,this._sendMessage=i}get ready(){return Promise.resolve()}get isDisposed(){return this._isDisposed}get disposed(){return this._disposed}get id(){return this._id}get name(){return this._name}get location(){return this._location}get executionCount(){return this._executionCount}get parentHeader(){return this._parentHeader}get parent(){return this._parent}dispose(){this.isDisposed||(this._isDisposed=!0,this._disposed.emit(void 0))}async handleMessage(e){switch(this._busy(e),this._parent=e,e.header.msg_type){case"kernel_info_request":await this._kernelInfo(e);break;case"execute_request":await this._execute(e);break;case"input_reply":this.inputReply(e.content);break;case"inspect_request":await this._inspect(e);break;case"is_complete_request":await this._isCompleteRequest(e);break;case"complete_request":await this._complete(e);break;case"history_request":await this._historyRequest(e);break;case"comm_open":await this.commOpen(e);break;case"comm_msg":await this.commMsg(e);break;case"comm_close":await this.commClose(e)}this._idle(e)}stream(e,t=void 0){var s;const r=void 0!==t?t:this._parentHeader,i=n.KernelMessage.createMessage({channel:"iopub",msgType:"stream",session:null!==(s=null==r?void 0:r.session)&&void 0!==s?s:"",parentHeader:r,content:e});this._sendMessage(i)}displayData(e,t=void 0){var s,r;const i=void 0!==t?t:this._parentHeader;e.metadata=null!==(s=e.metadata)&&void 0!==s?s:{};const a=n.KernelMessage.createMessage({channel:"iopub",msgType:"display_data",session:null!==(r=null==i?void 0:i.session)&&void 0!==r?r:"",parentHeader:i,content:e});this._sendMessage(a)}inputRequest(e,t=void 0){var s;const r=void 0!==t?t:this._parentHeader,i=n.KernelMessage.createMessage({channel:"stdin",msgType:"input_request",session:null!==(s=null==r?void 0:r.session)&&void 0!==s?s:"",parentHeader:r,content:e});this._sendMessage(i)}publishExecuteResult(e,t=void 0){var s;const r=void 0!==t?t:this._parentHeader,i=n.KernelMessage.createMessage({channel:"iopub",msgType:"execute_result",session:null!==(s=null==r?void 0:r.session)&&void 0!==s?s:"",parentHeader:r,content:e});this._sendMessage(i)}publishExecuteError(e,t=void 0){var s;const r=void 0!==t?t:this._parentHeader,i=n.KernelMessage.createMessage({channel:"iopub",msgType:"error",session:null!==(s=null==r?void 0:r.session)&&void 0!==s?s:"",parentHeader:r,content:e});this._sendMessage(i)}updateDisplayData(e,t=void 0){var s;const r=void 0!==t?t:this._parentHeader,i=n.KernelMessage.createMessage({channel:"iopub",msgType:"update_display_data",session:null!==(s=null==r?void 0:r.session)&&void 0!==s?s:"",parentHeader:r,content:e});this._sendMessage(i)}clearOutput(e,t=void 0){var s;const r=void 0!==t?t:this._parentHeader,i=n.KernelMessage.createMessage({channel:"iopub",msgType:"clear_output",session:null!==(s=null==r?void 0:r.session)&&void 0!==s?s:"",parentHeader:r,content:e});this._sendMessage(i)}handleComm(e,t,s,r,i=void 0){var a;const o=void 0!==i?i:this._parentHeader,c=n.KernelMessage.createMessage({channel:"iopub",msgType:e,session:null!==(a=null==o?void 0:o.session)&&void 0!==a?a:"",parentHeader:o,content:t,metadata:s,buffers:r});this._sendMessage(c)}_idle(e){const t=n.KernelMessage.createMessage({msgType:"status",session:e.header.session,parentHeader:e.header,channel:"iopub",content:{execution_state:"idle"}});this._sendMessage(t)}_busy(e){const t=n.KernelMessage.createMessage({msgType:"status",session:e.header.session,parentHeader:e.header,channel:"iopub",content:{execution_state:"busy"}});this._sendMessage(t)}async _kernelInfo(e){const t=await this.kernelInfoRequest(),s=n.KernelMessage.createMessage({msgType:"kernel_info_reply",channel:"shell",session:e.header.session,parentHeader:e.header,content:t});this._sendMessage(s)}async _historyRequest(e){const t=e,s=n.KernelMessage.createMessage({msgType:"history_reply",channel:"shell",parentHeader:t.header,session:e.header.session,content:{status:"ok",history:this._history}});this._sendMessage(s)}_executeInput(e){const t=e,s=t.content.code,r=n.KernelMessage.createMessage({msgType:"execute_input",parentHeader:t.header,channel:"iopub",session:e.header.session,content:{code:s,execution_count:this._executionCount}});this._sendMessage(r)}async _execute(e){const t=e,s=t.content;s.store_history&&this._executionCount++,this._parentHeader=t.header,this._executeInput(t),s.store_history&&this._history.push([0,0,s.code]);const r=await this.executeRequest(t.content),i=n.KernelMessage.createMessage({msgType:"execute_reply",channel:"shell",parentHeader:t.header,session:e.header.session,content:r});this._sendMessage(i)}async _complete(e){const t=e,s=await this.completeRequest(t.content),r=n.KernelMessage.createMessage({msgType:"complete_reply",parentHeader:t.header,channel:"shell",session:e.header.session,content:s});this._sendMessage(r)}async _inspect(e){const t=e,s=await this.inspectRequest(t.content),r=n.KernelMessage.createMessage({msgType:"inspect_reply",parentHeader:t.header,channel:"shell",session:e.header.session,content:s});this._sendMessage(r)}async _isCompleteRequest(e){const t=e,s=await this.isCompleteRequest(t.content),r=n.KernelMessage.createMessage({msgType:"is_complete_reply",parentHeader:t.header,channel:"shell",session:e.header.session,content:s});this._sendMessage(r)}}var a=s(28748),o=s(22742),c=s(57179),l=s(89909),u=s(68211);new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");const h=new Error("request for lock canceled");var d=function(e,t,s,n){return new(s||(s=Promise))((function(r,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}c((n=n.apply(e,t||[])).next())}))};class p{constructor(e,t=h){if(this._maxConcurrency=e,this._cancelError=t,this._queue=[],this._waiters=[],e<=0)throw new Error("semaphore must be initialized to a positive value");this._value=e}acquire(){const e=this.isLocked(),t=new Promise(((e,t)=>this._queue.push({resolve:e,reject:t})));return e||this._dispatch(),t}runExclusive(e){return d(this,void 0,void 0,(function*(){const[t,s]=yield this.acquire();try{return yield e(t)}finally{s()}}))}waitForUnlock(){return d(this,void 0,void 0,(function*(){return this.isLocked()?new Promise((e=>this._waiters.push({resolve:e}))):Promise.resolve()}))}isLocked(){return this._value<=0}release(){if(this._maxConcurrency>1)throw new Error("this method is unavailable on semaphores with concurrency > 1; use the scoped release returned by acquire instead");if(this._currentReleaser){const e=this._currentReleaser;this._currentReleaser=void 0,e()}}cancel(){this._queue.forEach((e=>e.reject(this._cancelError))),this._queue=[]}_dispatch(){const e=this._queue.shift();if(!e)return;let t=!1;this._currentReleaser=()=>{t||(t=!0,this._value++,this._resolveWaiters(),this._dispatch())},e.resolve([this._value--,this._currentReleaser])}_resolveWaiters(){this._waiters.forEach((e=>e.resolve())),this._waiters=[]}}class g{constructor(e){this._semaphore=new p(1,e)}acquire(){return e=this,t=void 0,n=function*(){const[,e]=yield this._semaphore.acquire();return e},new((s=void 0)||(s=Promise))((function(r,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}c((n=n.apply(e,t||[])).next())}));var e,t,s,n}runExclusive(e){return this._semaphore.runExclusive((()=>e()))}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.release()}cancel(){return this._semaphore.cancel()}}var _=s(84651);const f=l.supportedKernelWebSocketProtocols.v1KernelWebsocketJupyterOrg;class m{constructor(e){this._kernels=new o.E,this._clients=new o.E,this._kernelClients=new o.E,this._changed=new r.Signal(this);const{kernelspecs:t}=e;this._kernelspecs=t,this._kernels.changed.connect(((e,t)=>{this._changed.emit(t)}))}get changed(){return this._changed}async startNew(e){const{id:t,name:s,location:r}=e,i=this._kernelspecs.factories.get(s);if(!i)return{id:t,name:s};const o=new g,l=(e,t,s)=>{var n;const r=this._kernels.get(e);if(!r)throw Error(`No kernel ${e}`);this._clients.set(t,s),null===(n=this._kernelClients.get(e))||void 0===n||n.add(t),s.on("message",(async e=>{let t;if(e instanceof ArrayBuffer)e=new Uint8Array(e).buffer,t=(0,c.deserialize)(e,f);else{if("string"!=typeof e)return;{const s=(new TextEncoder).encode(e);t=(0,c.deserialize)(s.buffer,f)}}"input_reply"===t.header.msg_type?r.handleMessage(t):(async e=>{await o.runExclusive((async()=>{await r.ready,await r.handleMessage(e)}))})(t)}));const i=()=>{var s;this._clients.delete(t),null===(s=this._kernelClients.get(e))||void 0===s||s.delete(t)};r.disposed.connect(i),s.onclose=i},h=null!=t?t:u.UUID.uuid4(),d=a.URLExt.join(m.WS_BASE_URL,n.KernelAPI.KERNEL_SERVICE_URL,encodeURIComponent(h),"channels"),p=this._kernels.get(h);if(p)return{id:p.id,name:p.name};const y=await i({id:h,sendMessage:e=>{const t=e.header.session,s=this._clients.get(t);if(!s)return void console.warn(`Trying to send message on removed socket for kernel ${h}`);const n=(0,c.serialize)(e,f);if("iopub"!==e.channel)s.send(n);else{const e=this._kernelClients.get(h);null==e||e.forEach((e=>{var t;null===(t=this._clients.get(e))||void 0===t||t.send(n)}))}},name:s,location:r});this._kernels.set(h,y),this._kernelClients.set(h,new Set);const v=new _.Server(d,{mock:!1,selectProtocol:()=>f});return v.on("connection",(e=>{var t;const s=null!==(t=new URL(e.url).searchParams.get("session_id"))&&void 0!==t?t:"";l(h,s,e)})),v.on("close",(()=>{this._clients.keys().forEach((e=>{var t;const s=this._clients.get(e);(null==s?void 0:s.readyState)===WebSocket.CLOSED&&(this._clients.delete(e),null===(t=this._kernelClients.get(h))||void 0===t||t.delete(e))}))})),y.disposed.connect((()=>{v.close(),this._kernels.delete(h),this._kernelClients.delete(h)})),{id:y.id,name:y.name}}async restart(e){const t=this._kernels.get(e);if(!t)throw Error(`Kernel ${e} does not exist`);const{id:s,name:n,location:r}=t;return t.dispose(),this.startNew({id:s,name:n,location:r})}async list(){return[...this._kernels.values()].map((e=>({id:e.id,name:e.name})))}async shutdown(e){var t;null===(t=this._kernels.delete(e))||void 0===t||t.dispose()}async get(e){return this._kernels.get(e)}}!function(e){e.WS_BASE_URL=a.PageConfig.getBaseUrl().replace(/^http/,"ws")}(m||(m={}));const y=new u.Token("@jupyterlite/kernel:IKernels"),v="javascript",w=new u.Token("@jupyterlite/kernel:IKernelSpecs");class M{constructor(){this._specs=new Map,this._factories=new Map}get specs(){return 0===this._specs.size?null:{default:this.defaultKernelName,kernelspecs:Object.fromEntries(this._specs)}}get defaultKernelName(){let e=a.PageConfig.getOption("defaultKernelName");if(!e&&this._specs.size){const t=Array.from(this._specs.keys());t.sort(),e=t[0]}return e||v}get factories(){return this._factories}register(e){const{spec:t,create:s}=e;this._specs.set(t.name,t),this._factories.set(t.name,s)}}}}]);